<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSRF Route Visualization</title>

    <!-- Load D3.js Library for Visualization -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- Load Chart.js for Graphs -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Load JavaScript for Graph Visualization -->
    <script src="{{ url_for('static', filename='js/visualization.js') }}"></script>

    <!-- Load Custom Stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <h2>SSRF Route Visualization</h2>

    <!-- Search Bar for User Input -->
    <div id="search-container">
        <input type="url" id="url-input" placeholder="Enter URL to scan (e.g. http://example.com)" required>
        <button id="scan-btn">Scan</button>
        <button id="clear-btn">Clear Nodes</button>
        <p id="clear-message">User-added nodes cleared!</p>
    </div>

    <!-- Loading message shown during scanning -->
    <p id="loading-message" style="display:none; color: blue;">Scanning in progress...</p>

    <!-- Main Container for Visualization -->
    <div id="container">
        <!-- Graph Visualization -->
        <div id="visualization">
            <svg width="900" height="500"></svg>
        </div>

        <!-- Legend and Description Panel -->
        <div id="legend-description-container">
            <!-- Risk Level Legend -->
            <div id="legend">
                <h4>Legend</h4>
                <div class="legend-item">
                    <div class="legend-color" style="background: blue;"></div> Safe Node
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: yellow;"></div> Medium Risk
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: red;"></div> High Risk
                </div>
            </div>            
            
            <!-- Node Details Display Panel -->
            <div id="description">
                <h4>Visualization Details</h4>
                <p>Click on a node to see details. Red nodes indicate high-risk SSRF targets.</p>
            </div>
        </div>
        
        <section id="attack-type-chart">
            <h2>SSRF Attack Type Distribution</h2>
            <canvas id="attackTypeChart"></canvas>
        </section>
        
        <!-- SSRF Severity Distribution -->
        <section id="severity-chart">
            <h2>Severity Distribution of SSRF Vulnerabilities</h2>
            <canvas id="severityChart"></canvas>
        </section>
    </div>
</body>
</html>
